###############################
### Create bar-chart with
## members cooc, mean, median
###############################

statdata = defaultdict(dict)
for k, v in setcooc.items():
    statdata[k] = {
        'total': len(v),
        'maxim': max(v),
        'mean': float(np.mean(v)),
        'median': float(np.median(v)),
        'all': v,
    }
    #'AUT': {'bronze': 1, 'gold': 2, 'total': 9, 'silver': 6}, 'HRV': {'bronze': 0, 'gold': 0, 'total': 1, 'silver': 1}
#print(statdata)

assocsort = sorted(
    statdata.keys(),
    key=lambda x: statdata[x]['maxim'], reverse=True
)

maxim = np.array([statdata[a]['maxim'] for a in assocsort], dtype=np.float)
mean = np.array([statdata[a]['mean'] for a in assocsort], dtype=np.float)
median = np.array([statdata[a]['median'] for a in assocsort], dtype=np.float)

#output_file('asoc_data.html')

p2 = figure(title='Mexican Literary Assoc. members\' co-occurrence', tools="resize",
            x_range=assocsort, y_range=[0, max([maxim.max(), mean.max(), median.max()])],
            background_fill=None, plot_width=800, plot_height=400)

assoc_maxim = [c + ":0.3" for c in assocsort]
assoc_mean = [c + ":0.5" for c in assocsort]
assoc_median = [c + ":0.7" for c in assocsort]

p2.rect(x=assoc_maxim, y=maxim / 2, width=0.2, height=maxim, color="red", alpha=0.6, legend='max')
p2.rect(x=assoc_mean, y=mean / 2, width=0.2, height=mean, color="green", alpha=0.6, legend='mean')
p2.rect(x=assoc_median, y=median / 2, width=0.2, height=median, color="purple", alpha=0.6, legend='median')

p2.xgrid.grid_line_color = None
p2.axis.major_label_text_font_size = "7pt"
p2.axis.major_label_standoff = 0
p2.xaxis.major_label_orientation = np.pi / 4
p2.xaxis.major_label_standoff = 6
p2.xaxis.major_tick_out = 0

#show(p2)
